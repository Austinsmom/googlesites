<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with googlesites • googlesites</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with googlesites">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98603021-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">googlesites</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started-with-googlesites.html">Getting Started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/StevenMMortimer/googlesites">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Getting Started with googlesites</h1>
                        <h4 class="author">Steven Mortimer</h4>
            
            <h4 class="date">2018-03-27</h4>
          </div>

    
    
<div class="contents">
<p>First, we load <code>googlesites</code> and specify the domain and site name we’ll be working with. Creating a completely new site is only available to GSuite users (formerly known as Google Apps), so you should have already created a classic site using the web UI and know the domain and site name to plug into the package options. These options allow you to edit the site without specifying it explicitly on each request.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googlesites)
<span class="co"># set the name of your domain and site</span>
<span class="co"># this is required so the package knows which site to update</span>
<span class="kw">options</span>(<span class="dt">googlesites.site_domain =</span> <span class="st">"site"</span>) <span class="co"># or your Apps domain</span>
<span class="kw">options</span>(<span class="dt">googlesites.site_name =</span> <span class="st">"my-site"</span>)</code></pre></div>
<p>Second, you need to use the <code>googleAuthR</code> package to get your OAuth2.0 token to make edits to your site from the R script. If it’s your first time authenticating you RStudio will pop open your browser and ask you to authenticate interactively. After you’ve authenticated for the first time, a file called <code>.httr-oauth</code> will appear in your working directory. Every subsequent time that you run <code><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">gar_auth()</a></code> it will use the cached <code>.httr-oauth</code> file instead of making you do it interactively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleAuthR)
<span class="kw">options</span>(<span class="dt">googleAuthR.client_id =</span> <span class="kw">getOption</span>(<span class="st">"googlesites.client_id"</span>))
<span class="kw">options</span>(<span class="dt">googleAuthR.client_secret =</span> <span class="kw">getOption</span>(<span class="st">"googlesites.client_secret"</span>))
<span class="kw">options</span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="st">"https://sites.google.com/feeds/"</span>)
<span class="kw"><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">gar_auth</a></span>()</code></pre></div>
<div id="adding-a-page" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-a-page" class="anchor"></a>Adding a Page</h3>
<p>You can add a page based on a local, static HTML document. Webpages in Google Sites are based on HTML. You can specify new content with HTML that runs inside the template of your site. The HTML may not have some JavaScript and other potential security risks, so more advanced documents might need tweaking before deploying. Also, the data is transferred via XML, so your HTML must be XHTML compliant. This means that every tag should have a correpsonding closing tag. Do not write <code>&lt;img src="test.png"&gt;</code>. Instead you should write <code>&lt;img src="test.png" /&gt;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_html &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"example-site"</span>, <span class="st">"test.html"</span>, <span class="dt">package=</span><span class="st">"googlesites"</span>)
<span class="kw"><a href="../reference/add_html_page.html">add_html_page</a></span>(<span class="dt">page_xhtml_source =</span> test_html,
              <span class="dt">page_title =</span> <span class="st">'API Test'</span>,
              <span class="dt">page_custom_url =</span> <span class="st">'api-test'</span>,
              <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="finding-content" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-content" class="anchor"></a>Finding Content</h3>
<p>The package comes with a function to find content on your site. You can specify which field to search on (title, id, url), then find content matching your desired value against that field. You can also restrict to certain types of content like webpages, announcements, templates. Here is an example where we find the page we just created by its title.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'API Test'</span>, 
             <span class="dt">field_to_match=</span><span class="st">'title'</span>, 
             <span class="dt">content_category=</span><span class="st">'webpage'</span>)</code></pre></div>
<p>You can also find this page by its URL or it’s entry ID.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">page &lt;-<span class="st"> </span><span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'https://sites.google.com/site/sitesrtest/api-test'</span>, 
                     <span class="dt">field_to_match=</span><span class="st">'url'</span>, 
                     <span class="dt">content_category=</span><span class="st">'webpage'</span>)

<span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span>page<span class="op">$</span>id, 
             <span class="dt">field_to_match=</span><span class="st">'id'</span>, 
             <span class="dt">content_category=</span><span class="st">'webpage'</span>)</code></pre></div>
<p>The <code><a href="../reference/find_content.html">find_content()</a></code> function supports regex-style matching via <code>grep()</code>. If you want to search for all templates on your site, you can just search for “*“.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">templates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'*'</span>, 
                          <span class="dt">field_to_match=</span><span class="st">'title'</span>, 
                          <span class="dt">use_regex_matching=</span><span class="ot">TRUE</span>,
                          <span class="dt">content_category=</span><span class="st">'template'</span>)
templates</code></pre></div>
<p>A nice feature about <code><a href="../reference/add_html_page.html">add_html_page()</a></code> is that you can specify a template that you would like the page to be created with by providing the template ID. In this example we’ll add the page using the first template we found. This one hides the title and turns off sublinks at the bottom of the page.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_html &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"example-site"</span>, <span class="st">"sample-doc.html"</span>, <span class="dt">package=</span><span class="st">"googlesites"</span>)
<span class="kw"><a href="../reference/add_html_page.html">add_html_page</a></span>(<span class="dt">page_xhtml_source =</span> sample_html,
              <span class="dt">page_title =</span> <span class="st">'Post with GIF'</span>,
              <span class="dt">page_custom_url =</span> <span class="st">'post-with-gif'</span>,
              <span class="dt">page_template_id =</span> templates<span class="op">$</span>id[<span class="dv">1</span>])</code></pre></div>
</div>
<div id="adding-an-attachment" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-an-attachment" class="anchor"></a>Adding an Attachment</h3>
<p>Once you’ve got pages up and running, it’s easy to programmatically attach content to those pages. In this example, we’re pulling down the RMarkdown cheatsheet from RStudio and attaching it to our “Post with GIF” page. You should see the attachment at the bottom of the page if you have page settings that show attachments. The nice thing about Google Sites is that if you re-upload something with the same name to the same page, it keeps track of it’s revision number so you can always go back and get old versions of a file that you upload.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pdf_cheatsheet &lt;-<span class="st"> 'https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf'</span>
<span class="kw">download.file</span>(pdf_cheatsheet, <span class="st">'rmarkdown-cheatsheet-2.0.pdf'</span>, <span class="dt">mode=</span><span class="st">"wb"</span>)

<span class="kw"><a href="../reference/upload_file_to_site.html">upload_file_to_site</a></span>(<span class="dt">local_file_path =</span> <span class="st">"rmarkdown-cheatsheet-2,0.pdf"</span>, 
                    <span class="dt">file_summary =</span> <span class="st">'R Markdown is an authoring format that makes it </span>
<span class="st">                    easy to write reusable reports with R. You combine your R code </span>
<span class="st">                    with narration written in markdown (an easy-to-write plain text format) </span>
<span class="st">                    and then export the results as an html, pdf, or Word file. You can </span>
<span class="st">                    even use R Markdown to build interactive documents and slideshows. </span>
<span class="st">                    Updated 02/16.'</span>,
                    <span class="dt">parent_page_id =</span> <span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'Post with GIF'</span>, 
                                                  <span class="dt">field_to_match=</span><span class="st">'title'</span>)<span class="op">$</span>id)</code></pre></div>
</div>
<div id="deleting-content" class="section level3">
<h3 class="hasAnchor">
<a href="#deleting-content" class="anchor"></a>Deleting Content</h3>
<p>Of course you can delete content from your site as well. If you don’t want that PDF attachment anymore, then just find it’s ID and remove it. In this example, note the use of the <code>parent_page_id</code> argument so that we don’t accidentally remove the PDF if it exists somewhere else on the site with the same name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># deleting the attachment</span>
<span class="kw"><a href="../reference/delete_content.html">delete_content</a></span>(<span class="dt">id =</span> <span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'rmarkdown-cheatsheet-2.0.pdf'</span>,
                                 <span class="dt">field_to_match=</span><span class="st">'title'</span>, 
                                 <span class="dt">parent_page_id=</span><span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'Post with GIF'</span>, 
                                                  <span class="dt">field_to_match=</span><span class="st">'title'</span>)<span class="op">$</span>id,
                                 <span class="dt">content_category=</span><span class="st">'attachment'</span>)<span class="op">$</span>id)</code></pre></div>
</div>
<div id="deleting-page" class="section level3">
<h3 class="hasAnchor">
<a href="#deleting-page" class="anchor"></a>Deleting Page</h3>
<p>You can even delete the first sample page we created. We recommend pausing your script in between deletions and insertions because the Sites API is sometimes slow at receiving and reflecting many rapid API calls to change content.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># deleting page</span>
<span class="kw"><a href="../reference/delete_content.html">delete_content</a></span>(<span class="dt">id =</span> <span class="kw"><a href="../reference/find_content.html">find_content</a></span>(<span class="dt">value_to_match=</span><span class="st">'API Test'</span>,
                                 <span class="dt">field_to_match=</span><span class="st">'title'</span>)<span class="op">$</span>id)</code></pre></div>
<p>Thats it! You can use these functions to automatically upload content and manage your Google Site. The beautiful thing is that you can version control the contents and repush any content as needed without fussing with the Web UI. It’s recommended that you keep your site files all in one folder so you can keep track of them all. There is an example site folder bundled with the package and available <a href="https://github.com/StevenMMortimer/googlesites/tree/master/inst/extdata/example-site">here</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Steven M. Mortimer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
